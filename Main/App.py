
from rich.style import Style
from rich.progress import Progress
from rich.progress import (BarColumn,Progress,SpinnerColumn,TaskProgressColumn,TimeElapsedColumn,)
import typer
import time
from scapy.layers.inet import *
import ipaddress

#<<<<<<<<<<< Vars & Constants >>>>>>>>>>>>>

# Define custom progress bar
progress_columns = (
    SpinnerColumn(),
    "[progress.description]{task.description}",
    BarColumn(complete_style = Style(color="#45f542"),finished_style = Style(color="#130454")),
    TaskProgressColumn(text_format = "[progress.percentage][bold blue]{task.percentage:>3.0f}%"),
    "Elapsed:",
    TimeElapsedColumn(),
)
#<<<<<<<<<<< Functions >>>>>>>>>>>>>

# Progress bar function
def pb(func,total=100):
    with Progress(*progress_columns) as progress_bar:
        task = progress_bar.add_task(f"[blue]{func.__name__} running...", total=total)
        for i in progress_bar.track(func(), task_id=task):
            pass
        progress_bar.update(task, description=f"[blue]{func.__name__} done.", advance=total)


ports = [25,80,53,443,445,8080,8443]

def SynScan(host):
    ans,unans = sr(
        IP(dst=host)/
        TCP(sport=33333,dport=ports,flags="S")
        ,timeout=2,verbose=0)
    print("Open ports at %s:" % host)
    for (s,r,) in ans:
        if s[TCP].dport == r[TCP].sport and r[TCP].flags=="SA":
            print(s[TCP].dport)
 
#<<<<<<<<<<< Main >>>>>>>>>>>>>

def main(hostname: str):
    typer.echo(f"Target host name: {hostname}")

typer.run(main)

